<html>
<head>
	<title>HXTool - Please Authenticate</title>
	<link rel="stylesheet" type="text/css" href="static/ht.css">
	<script type="text/javascript" src="/static/jquery-1.11.3.min.js"></script>
		<script type="text/javascript" src="/static/jquery.dataTables.min.js"></script>
</head>

<script>
	$(document).ready(function() {
		
		// TODO: We need to rebind both the drop down and manager data table anytime there is a change
		$.ajax({
			type: "GET",
			url: "/profile",
			contentType: "application/json; charset=utf-8",
			dataType: "json",
			success: function(r) {
				$("#controllerProfileDropdown").empty();
				$("#controllerProfileTable tbody").empty();			
				$.each(r.data, function() {
					// TODO: implementing a string format function would be nicer...
					$("#controllerProfileDropdown").append($("<option></option>").val(this._id).text(this.hx_name + " - " + this.hx_host + ":" + this.hx_port));
					$("#controllerProfileTable tbody").append("<tr><td>" + this._id + "</td><td>" + this.hx_name + "</td><td>" + this.hx_host + "</td><td>" + this.hx_port + "</td></tr>");
				});
				
			}
		});
		
		
		
		$("#controllerProfileManagerButton").click(function() {
			$("#controllerProfileManagerPanel").show();
		});
	});
</script>

<body style='background: #eeeeee;'>
	<div class='ht_auth_center'>
		<div class='ht_auth_wrap'>
			<div class='ht_auth_placeholder'>
				<form method='post'>
				
					<div class='ht_auth_title'><img src='/static/fireeye.svg' style='width: 200px;'></div>
					
					<div class='tableTitle' style='font-size: 28px; margin-bottom: 18px; text-align: center;'>HXTool&trade; v2.0</div>
					{% if fail %}
						<div class='tableTitle' style='font-size: 10px; text-align: center; color: red; margin-bottom: 10px;'>
						{{ fail }}
						</div>
					{% endif %}
					<div class='ht_input_title' style='font-weight: bold; font-size: 12px;'>USERNAME</div>
					<input style='width: 100%; border: 1px solid #aaaaaa; border-radius: 3px; font-size: 18px; outline: none;' type='text' name='ht_user' id='ht_user'>
					<br><br>
					<div class='ht_input_title' style='font-weight: bold; font-size: 12px;'>PASSWORD</div>
					<input style='width: 100%; border: 1px solid #aaaaaa; border-radius: 3px; font-size: 18px; outline: none;' type='password' name='ht_pass' id='ht_pass'>
					<br><br>
					<div class='ht_input_title' style='font-weight: bold; font-size: 12px;'>CONTROLLER PROFILE</div>
					<select style='width: 100%; border: 1px solid #aaaaaa; border-radius: 3px; font-size: 18px; outline: none;' name='controllerProfileDropdown' id='controllerProfileDropdown'>
					</select>		
					<br>
					<div style='padding-top: 10px;'>
						<a id='controllerProfileManagerButton' class='tableActionButton' href='#'>Controller Profile Manager</a>
					</div>
					<br><br>
					
					<input style='width: 100%; height: 50px;' type='submit' value='Login'>
					<div style='font-size: 12px; text-align: center; margin-top: 20px;'>Use HX API Credentials to login<br><br>Copyright &copy; 2017 by FireEye, Inc. All rights reserved</div>
				</form>
			</div>
		</div>
	</div>
	<div id='controllerProfileManagerPanel' class='profilePopup' style='display: none;'>
		<a href='#' style='text-decoration: none; left: 550px;' onclick='JavaScript: $("#controllerProfileManagerPanel").hide();'>&times;</a>
		<table class='genericTable' id='controllerProfileTable'>
			<thead>
				<th>#</th>
				<th>Name</th>
				<th>Hostname/IP</th>
				<th>Port</th>
			</thead>
			<tbody></tbody>
			<tfoot>
				
			</tfoot>
		</table>
	</div>
</body>
</html>
